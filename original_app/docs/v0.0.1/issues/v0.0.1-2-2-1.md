# Title: v0.0.1-2-2-1 - Add Message Tasker Button to Task Details

## Summary: 
Add "Message Tasker" buttons to bid and offer cards in the TaskDetail component, enabling customers to easily initiate conversations with taskers directly from task management interface.

### Acceptance Criteria:
- [ ] "Message Tasker" button added to each bid card
- [ ] "Message Tasker" button added to each offer card
- [ ] Button click navigates to Messages view with tasker pre-selected
- [ ] Task context (task_id) automatically associated with new conversation
- [ ] Button disabled/hidden when viewing own bids (no self-messaging)
- [ ] Loading state displayed during navigation
- [ ] Button styling follows design system (primary action button)
- [ ] Keyboard accessible (Enter key activates button)
- [ ] Screen reader compatible

### Test Strategy:

**Unit Tests (Jest/React Testing Library):**
- Test button renders on bid cards
- Test button renders on offer cards
- Test button hidden for own bids
- Test navigation triggered on click
- Test task context preserved
- Test loading state display
- Test keyboard navigation

**Tools:** Jest, React Testing Library
**Coverage Target:** >85%

---

## ðŸ–¥ï¸ Front End Components (If Applicable)

**Component Name:** `TaskDetail.js`

**Description:**
Add "Message Tasker" button to bid and offer cards that navigates to Messages component with pre-selected conversation and task context.

**Code:**

```jsx
// app/frontend/src/components/TaskDetail.js

import { useNavigate } from 'react-router-dom';

const TaskDetail = ({ user }) => {
  const navigate = useNavigate();
  const [task, setTask] = useState(null);
  const [bids, setBids] = useState([]);
  const [offers, setOffers] = useState([]);
  
  const handleMessageTasker = (taskerId, taskerName, taskId) => {
    // Navigate to messaging with pre-selected conversation
    navigate('/messages', {
      state: {
        preselectedUserId: taskerId,
        preselectedUserName: taskerName,
        taskId: taskId
      }
    });
  };
  
  return (
    <div className="task-detail">
      <h2>{task?.title}</h2>
      
      {/* Bids Section */}
      <div className="bids-section">
        <h3>Bids</h3>
        {bids.map(bid => (
          <div key={bid.id} className="bid-card">
            <p><strong>Tasker:</strong> {bid.tasker_name}</p>
            <p><strong>Amount:</strong> ${bid.amount}</p>
            <p><strong>Message:</strong> {bid.message}</p>
            
            {user.role === 'customer' && (
              <button
                className="btn btn-primary message-tasker-btn"
                onClick={() => handleMessageTasker(
                  bid.tasker_id,
                  bid.tasker_name,
                  task.id
                )}
              >
                Message Tasker
              </button>
            )}
          </div>
        ))}
      </div>
      
      {/* Offers Section */}
      <div className="offers-section">
        <h3>My Offers</h3>
        {offers.map(offer => (
          <div key={offer.id} className="offer-card">
            <p><strong>Tasker:</strong> {offer.tasker_name}</p>
            <p><strong>Amount:</strong> ${offer.amount}</p>
            <p><strong>Status:</strong> {offer.status}</p>
            
            {user.role === 'customer' && (
              <button
                className="btn btn-primary message-tasker-btn"
                onClick={() => handleMessageTasker(
                  offer.tasker_id,
                  offer.tasker_name,
                  task.id
                )}
              >
                Message Tasker
              </button>
            )}
          </div>
        ))}
      </div>
    </div>
  );
};

export default TaskDetail;
```

**File:** `app/frontend/src/components/Messages.js`

```diff
+ import { useLocation } from 'react-router-dom';

  const Messages = ({ user }) => {
+   const location = useLocation();
    const [conversations, setConversations] = useState([]);
    const [selectedConversation, setSelectedConversation] = useState(null);
    
    useEffect(() => {
      loadMessages();
+     
+     // Handle pre-selected conversation from navigation
+     if (location.state?.preselectedUserId) {
+       const preselectedConv = conversations.find(
+         conv => conv.partnerId === location.state.preselectedUserId
+       );
+       if (preselectedConv) {
+         handleSelectConversation(preselectedConv);
+       }
+     }
    }, []);
    
    // ... rest of component
  };
```

---

## Issue Dependencies

**Depends on:**
- v0.0.1-2-1-2 - Update Messages Component to Display User Details
- v0.0.1-1-2-1 - Add Task Context to Message Creation (Backend)

**Blocks:**
- v0.0.1-3-1-1 - Bid-Based Messaging Integration

## Related Issues

- v0.0.1-2-1-2 - Update Messages Component to Display User Details
- v0.0.1-3-1-1 - Bid-Based Messaging Integration
- v0.0.1-3-2-1 - Offer-Based Messaging Integration