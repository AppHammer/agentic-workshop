# Title: v0.0.1-1-1-4 - Add Profile Route and Integration

## Summary: 
Integrate the Profile component into the application routing system by adding a protected `/profile` route in App.jsx and creating the corresponding API client function in api.js to fetch profile data from the backend endpoint.

### Acceptance Criteria:
- [ ] Route added to App.jsx with `/profile` path
- [ ] Route uses PrivateRoute component for authentication protection
- [ ] Profile component imported and rendered for the route
- [ ] profileAPI object created in api.js with getMyProfile method
- [ ] API endpoint path matches backend implementation (`/users/me/profile`)
- [ ] JWT token automatically included via Axios interceptor
- [ ] Route accessible from any authenticated page
- [ ] Unauthenticated users redirected to login page
- [ ] Browser refresh on `/profile` route maintains authentication
- [ ] Navigation state preserved when navigating to/from profile
- [ ] Integration testing passed with authenticated and unauthenticated users

### Test Strategy:

**Types of Tests:**
- Integration testing
- Authentication flow testing
- Manual testing

**Test Cases:**
1. **Authenticated Navigation**: Login and navigate to /profile via URL and link
2. **Unauthenticated Access**: Attempt to access /profile without login, verify redirect
3. **Token Inclusion**: Verify API request includes Authorization header with JWT
4. **Browser Refresh**: Refresh page on /profile route, verify authentication persists
5. **Navigation Flow**: Navigate Dashboard ‚Üí Profile ‚Üí TaskList, verify smooth transitions
6. **Logout Behavior**: Logout from profile page, verify redirect to login
7. **Direct URL Access**: Enter /profile directly in browser while logged in

**Tools:**
- Manual browser testing
- Chrome DevTools Network tab (verify Authorization header)
- Console logging for debugging

---

## üìù Code Changes

**Description:**
Add a new protected route for the Profile page in the main App.jsx routing configuration. Create the API client function in api.js to communicate with the backend profile endpoint. Both changes follow existing patterns established in the codebase.

**File:** `frontend/src/App.jsx`
```diff
  import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';
  import { AuthProvider } from './AuthContext';
  import Navigation from './components/Navigation';
  import Login from './pages/Login';
  import Register from './pages/Register';
  import Dashboard from './pages/Dashboard';
  import TaskList from './pages/TaskList';
  import TaskDetail from './pages/TaskDetail';
  import CreateTask from './pages/CreateTask';
  import MyBids from './pages/MyBids';
  import Agreements from './pages/Agreements';
  import Messages from './pages/Messages';
+ import Profile from './pages/Profile';
  import './App.css';

  // PrivateRoute component remains unchanged
  function PrivateRoute({ children }) {
    const token = localStorage.getItem('token');
    return token ? children : <Navigate to="/login" />;
  }

  function App() {
    return (
      <AuthProvider>
        <Router>
          <div className="App">
            <Routes>
              <Route path="/login" element={<Login />} />
              <Route path="/register" element={<Register />} />
              <Route path="/" element={<Navigate to="/dashboard" />} />
              
              <Route path="/dashboard" element={
                <PrivateRoute>
                  <Navigation />
                  <Dashboard />
                </PrivateRoute>
              } />
              
              <Route path="/tasks" element={
                <PrivateRoute>
                  <Navigation />
                  <TaskList />
                </PrivateRoute>
              } />
              
              <Route path="/tasks/:id" element={
                <PrivateRoute>
                  <Navigation />
                  <TaskDetail />
                </PrivateRoute>
              } />
              
              <Route path="/create-task" element={
                <PrivateRoute>
                  <Navigation />
                  <CreateTask />
                </PrivateRoute>
              } />
              
              <Route path="/my-bids" element={
                <PrivateRoute>
                  <Navigation />
                  <MyBids />
                </PrivateRoute>
              } />
              
              <Route path="/agreements" element={
                <PrivateRoute>
                  <Navigation />
                  <Agreements />
                </PrivateRoute>
              } />
              
              <Route path="/messages" element={
                <PrivateRoute>
                  <Navigation />
                  <Messages />
                </PrivateRoute>
              } />
              
+             <Route path="/profile" element={
+               <PrivateRoute>
+                 <Navigation />
+                 <Profile />
+               </PrivateRoute>
+             } />
            </Routes>
          </div>
        </Router>
      </AuthProvider>
    );
  }

  export default App;
```

**File:** `frontend/src/api.js`
```diff
  import axios from 'axios';

  const API_URL = 'http://localhost:8000';

  const api = axios.create({
    baseURL: API_URL,
  });

  // Add token to requests
  api.interceptors.request.use((config) => {
    const token = localStorage.getItem('token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  });

  export const authAPI = {
    register: (data) => api.post('/register', data),
    login: (data) => api.post('/token', data, {
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      transformRequest: [(data) => {
        const params = new URLSearchParams();
        params.append('username', data.username);
        params.append('password', data.password);
        return params;
      }]
    }),
    getCurrentUser: () => api.get('/users/me'),
  };

+ export const profileAPI = {
+   getMyProfile: () => api.get('/users/me/profile'),
+ };

  export const taskAPI = {
    create: (data) => api.post('/tasks', data),
    list: (status) => api.get('/tasks', { params: { status } }),
    get: (id) => api.get(`/tasks/${id}`),
    updateStatus: (id, status) => api.put(`/tasks/${id}/status`, null, { params: { status } }),
  };

  export const bidAPI = {
    create: (data) => api.post('/bids', data),
    getMyBids: () => api.get('/bids/my-bids'),
    accept: (id) => api.put(`/bids/${id}/accept`),
  };

  export const agreementAPI = {
    list: () => api.get('/agreements'),
    markPaid: (id) => api.put(`/agreements/${id}/pay`),
  };

  export const reviewAPI = {
    create: (data) => api.post('/reviews', data),
    getTaskerReviews: (taskerId) => api.get(`/reviews/tasker/${taskerId}`),
  };

  export const messageAPI = {
    send: (data) => api.post('/messages', data),
    list: () => api.get('/messages'),
    markRead: (id) => api.put(`/messages/${id}/read`),
  };

  export default api;
```

---

## üì° API Specs (If Applicable)

**Client-Side API Function:**

```javascript
// profileAPI.getMyProfile()
// Returns: Promise<AxiosResponse>
// Response data structure matches backend UserProfile schema

const response = await profileAPI.getMyProfile();
// response.data = {
//   id: 1,
//   username: "johndoe",
//   email: "john@example.com",
//   user_type: "tasker",
//   created_at: "2024-01-15T10:30:00Z",
//   skills: "Plumbing, Electrical Work",
//   hourly_rate: 45.00
// }
```

---

## üì¶ Dependencies (If Applicable)

No new dependencies required. Uses existing:

**Package Manager:** `npm`
- `react-router-dom@^6.20.0` (already installed)
- `axios@^1.6.2` (already installed)
- `react@^18.2.0` (already installed)

---

## Issue Dependencies

- **Depends on:** v0.0.1-1-1-1 - Backend API Endpoint for User Profile (backend endpoint must exist)
- **Depends on:** v0.0.1-1-1-3 - Create Profile Page Component (component must exist to be routed)

## Related Issues

- v0.0.1-1-1-2 - Make Navigation Username Clickable (uses this route)
- v0.0.1-1-1-5 - Conditional Tasker Fields Display (Profile component uses this integration)
- v0.0.1-1-1-6 - Error Handling and Loading States (Profile component uses this integration)